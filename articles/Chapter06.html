<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 • BayesianLearningCode</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 6">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BayesianLearningCode</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Chapter01.html">Chapter 1: From Bayes’ Rule to Bayes’ Theorem</a></li>
    <li><a class="dropdown-item" href="../articles/Chapter02.html">Chapter 2: A First Bayesian Analysis of Count Data</a></li>
    <li><a class="dropdown-item" href="../articles/Chapter03.html">Chapter 3: A First Bayesian Analysis of Unknown Probabilities</a></li>
    <li><a class="dropdown-item" href="../articles/Chapter04.html">Chapter 4: A First Bayesian Analysis of Continuous Data</a></li>
    <li><a class="dropdown-item" href="../articles/Chapter05.html">Chapter 5: Learning More About Bayesian Learning</a></li>
    <li><a class="dropdown-item" href="../articles/Chapter06.html">Chapter 6</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Chapter 6</h1>
            
      

      <div class="d-none name"><code>Chapter06.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="example-6-1">Example 6.1<a class="anchor" aria-label="anchor" href="#example-6-1"></a>
</h2>
</div>
<div class="section level2">
<h2 id="movie-data">Movie data<a class="anchor" aria-label="anchor" href="#movie-data"></a>
</h2>
<p>We use movie data provided as “movies.rda” to illustrate Bayesian
analysis of a regression model. The data set is a preprocessed version
of the one provided by Lehrer and Xi (2017). First of all, as there is
only one film of genre G, we set the baseline for the categorical
covariate genre to G or PG by removing PG from the data set.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://gregorkastner.github.io/BayesianLearningCode/">"BayesianLearningCode"</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"movies"</span>, package <span class="op">=</span> <span class="st">"BayesianLearningCode"</span><span class="op">)</span></span>
<span><span class="va">movies</span><span class="op">[</span><span class="st">"PG"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>Next we prepare the variables for regression analysis. We define the
response variable OpenBoxOffice as y and center the covariates at
zero.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span><span class="op">&lt;-</span> <span class="va">movies</span><span class="op">[</span>, <span class="st">"OpenBoxOffice"</span><span class="op">]</span></span>
<span></span>
<span><span class="va">data.cen</span> <span class="op">&lt;-</span> <span class="va">movies</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">vbin</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Action"</span>,<span class="st">"Adventure"</span>,<span class="st">"Animation"</span>,<span class="st">"Comedy"</span>,<span class="st">"Crime"</span>, </span>
<span>  <span class="st">"Drama"</span>, <span class="st">"Family"</span>,<span class="st">"Fantasy"</span>, <span class="st">"Mystery"</span>, <span class="st">"Romance"</span>,</span>
<span>  <span class="st">"Sci-Fi"</span>, <span class="st">"Thriller"</span>, <span class="st">"PG13"</span>, <span class="st">"R"</span><span class="op">)</span> </span>
<span><span class="va">data.cen</span><span class="op">[</span>,<span class="va">vbin</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">movies</span><span class="op">[</span>,<span class="va">vbin</span><span class="op">]</span>,scale<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">vmetr</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Budget"</span>, <span class="st">"Weeks"</span>, <span class="st">"Screens"</span>, </span>
<span>          <span class="st">"S-21-27"</span>,<span class="st">"S-14-20"</span>,<span class="st">"S-7-13"</span>,<span class="st">"S-4-6"</span>,<span class="st">"S-1-3"</span>,</span>
<span>          <span class="st">"Vol-21-27"</span>,<span class="st">"Vol-14-20"</span>,<span class="st">"Vol-7-13"</span>,<span class="st">"Vol-4-6"</span>,</span>
<span>          <span class="st">"Vol-1-3"</span><span class="op">)</span></span>
<span><span class="va">data.cen</span><span class="op">[</span>,<span class="va">vmetr</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">movies</span><span class="op">[</span>,<span class="va">vmetr</span><span class="op">]</span>,scale<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">N</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>  <span class="co"># number of Observations</span></span>
<span><span class="va">X</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">N</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">data.cen</span><span class="op">)</span><span class="op">)</span> <span class="co"># Regressor matrix</span></span>
<span><span class="va">d</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="fl">1</span> <span class="co"># regression effects except the intercept</span></span></code></pre></div>
<p>We first estimate the parameters of the regression model under a
rather flat semi-conjugate prior.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define prior parameters</span></span>
<span><span class="va">B0.inv</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">10000</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">100</span>,<span class="va">d</span><span class="op">)</span><span class="op">)</span>, nrow<span class="op">=</span><span class="va">d</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">b0</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">d</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c0</span><span class="op">=</span><span class="fl">2.5</span> </span>
<span><span class="va">C0</span><span class="op">=</span><span class="fl">1.5</span></span>
<span></span>
<span><span class="co"># define quantities for the Gibbs sampler</span></span>
<span><span class="va">XX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="va">Xy</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">y</span></span>
<span><span class="va">cN</span><span class="op">=</span><span class="va">c0</span><span class="op">+</span><span class="va">N</span><span class="op">/</span><span class="fl">2</span></span>
<span></span>
<span><span class="co">#define burnin and M</span></span>
<span><span class="va">burnin</span><span class="op">=</span><span class="fl">1000</span></span>
<span><span class="va">M</span><span class="op">=</span><span class="fl">5000</span></span>
<span></span>
<span><span class="co"># prepare storing of results</span></span>
<span><span class="va">betas</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow<span class="op">=</span><span class="va">burnin</span><span class="op">+</span><span class="va">M</span>, ncol<span class="op">=</span><span class="va">d</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">sigma2s</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="va">burnin</span><span class="op">+</span><span class="va">M</span> <span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">"mvtnorm"</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: mvtnorm</span></span>
<span></span>
<span><span class="co"># starting value for sigma2</span></span>
<span><span class="va">sigma2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">m</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">burnin</span><span class="op">+</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co"># sample  beta from the full conditional</span></span>
<span>    <span class="va">Bn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">B0.inv</span><span class="op">+</span><span class="va">XX</span><span class="op">/</span><span class="va">sigma2</span><span class="op">)</span> </span>
<span>    <span class="va">bn</span> <span class="op">&lt;-</span> <span class="va">Bn</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="op">(</span><span class="va">B0.inv</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b0</span><span class="op">+</span><span class="va">Xy</span><span class="op">/</span><span class="va">sigma2</span><span class="op">)</span></span>
<span>    <span class="va">beta</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span>,mean<span class="op">=</span><span class="va">bn</span>,sigma<span class="op">=</span><span class="va">Bn</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># sample sigma^2 from its full conditional</span></span>
<span>    <span class="va">eps</span><span class="op">&lt;-</span><span class="va">y</span><span class="op">-</span><span class="va">X</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">beta</span></span>
<span>    <span class="va">CN</span><span class="op">&lt;-</span><span class="va">C0</span><span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">eps</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span>    <span class="va">sigma2</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/InvGammaDist.html">rinvgamma</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">cN</span>,<span class="va">CN</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">betas</span><span class="op">[</span><span class="va">m</span>,<span class="op">]</span><span class="op">&lt;-</span><span class="va">beta</span></span>
<span>    <span class="va">sigma2s</span><span class="op">[</span><span class="va">m</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">sigma2</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>To summarize the results nicely we compute equal tailed 95%
confidence intervals.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">eq.tails</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">0.025</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">0.975</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">beta.res1</span><span class="op">&lt;-</span> <span class="va">betas</span><span class="op">[</span><span class="va">burnin</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">M</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">beta.eq1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">beta.res1</span>,<span class="fl">2</span>,<span class="va">eq.tails</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">beta.res1</span><span class="op">)</span>, <span class="va">beta.eq1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">res1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data.cen</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"post.mean"</span>, <span class="st">"2.5%"</span>, <span class="st">"97.5"</span> <span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           post.mean    2.5%   97.5</span></span>
<span><span class="co">#&gt; Intercept    19.109  17.500 20.650</span></span>
<span><span class="co">#&gt; Action       -1.690  -6.663  3.442</span></span>
<span><span class="co">#&gt; Adventure     3.855  -1.314  8.854</span></span>
<span><span class="co">#&gt; Animation    -9.893 -17.349 -2.470</span></span>
<span><span class="co">#&gt; Comedy        1.978  -3.288  7.251</span></span>
<span><span class="co">#&gt; Crime         2.182  -2.318  6.687</span></span>
<span><span class="co">#&gt; Drama        -2.657  -7.718  2.552</span></span>
<span><span class="co">#&gt; Family        9.518   1.645 17.325</span></span>
<span><span class="co">#&gt; Fantasy       4.924  -1.918 11.785</span></span>
<span><span class="co">#&gt; Mystery       2.598  -3.674  8.790</span></span>
<span><span class="co">#&gt; Romance      -0.180  -5.941  5.008</span></span>
<span><span class="co">#&gt; Sci-Fi       -0.005  -6.052  6.295</span></span>
<span><span class="co">#&gt; Thriller      1.185  -3.971  6.475</span></span>
<span><span class="co">#&gt; PG13         -0.069  -6.372  6.167</span></span>
<span><span class="co">#&gt; R             3.885  -2.523 10.279</span></span>
<span><span class="co">#&gt; Budget        0.119   0.021  0.216</span></span>
<span><span class="co">#&gt; Weeks         0.547   0.156  0.933</span></span>
<span><span class="co">#&gt; Screens       0.931   0.525  1.330</span></span>
<span><span class="co">#&gt; S-21-27      -0.422  -1.667  0.760</span></span>
<span><span class="co">#&gt; S-14-20       0.056  -1.800  1.910</span></span>
<span><span class="co">#&gt; S-7-13        0.483  -2.392  3.387</span></span>
<span><span class="co">#&gt; S-4-6        -1.501  -5.193  2.194</span></span>
<span><span class="co">#&gt; S-1-3         2.695  -1.237  6.450</span></span>
<span><span class="co">#&gt; Vol-21-27    -7.500 -23.644  8.529</span></span>
<span><span class="co">#&gt; Vol-14-20    -0.764 -17.584 15.673</span></span>
<span><span class="co">#&gt; Vol-7-13     -4.518 -21.705 12.399</span></span>
<span><span class="co">#&gt; Vol-4-6      -5.716 -21.147  8.860</span></span>
<span><span class="co">#&gt; Vol-1-3      20.997  17.173 24.841</span></span>
<span></span>
<span><span class="va">sigma2.res1</span><span class="op">&lt;-</span> <span class="va">sigma2s</span><span class="op">[</span><span class="va">burnin</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">M</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sigma2.res1</span><span class="op">)</span>, <span class="fu">eq.tails</span><span class="op">(</span><span class="va">sigma2.res1</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          2.5%  97.5% </span></span>
<span><span class="co">#&gt; 60.375 43.676 83.717</span></span></code></pre></div>
<p>Next we use the horseshoe prior to analyse the data. We use the same
prior on the intercept but specify the horseshoe prior via latent
Inverse Gamma parameters.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">B0inv.intcpt</span><span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">10000</span></span>
<span><span class="va">b0</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">d</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">c0</span><span class="op">=</span><span class="fl">2.5</span> </span>
<span><span class="va">C0</span><span class="op">=</span><span class="fl">1.5</span></span>
<span></span>
<span><span class="co"># define quantities for the Gibbs sampler</span></span>
<span><span class="va">XX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="va">Xy</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">y</span></span>
<span><span class="va">cN</span><span class="op">=</span><span class="va">c0</span><span class="op">+</span><span class="va">N</span><span class="op">/</span><span class="fl">2</span></span>
<span></span>
<span><span class="co">#define burnin and M</span></span>
<span><span class="va">burnin</span><span class="op">=</span><span class="fl">1000</span></span>
<span><span class="va">M</span><span class="op">=</span><span class="fl">5000</span></span>
<span></span>
<span><span class="co"># prepare storing of results</span></span>
<span><span class="va">betas</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow<span class="op">=</span><span class="va">burnin</span><span class="op">+</span><span class="va">M</span>, ncol<span class="op">=</span><span class="va">d</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">lambda2s</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">burnin</span><span class="op">+</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="va">nus</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">burnin</span><span class="op">+</span><span class="va">M</span><span class="op">)</span></span>
<span><span class="va">tau2s</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow<span class="op">=</span><span class="va">burnin</span><span class="op">+</span><span class="va">M</span>, ncol<span class="op">=</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="va">xis</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow<span class="op">=</span><span class="va">burnin</span><span class="op">+</span><span class="va">M</span>, ncol<span class="op">=</span><span class="va">d</span><span class="op">)</span></span>
<span><span class="va">sigma2s</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>,<span class="va">burnin</span><span class="op">+</span><span class="va">M</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># starting value for sigma2</span></span>
<span><span class="va">sigma2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span></span>
<span><span class="va">lambda2</span><span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">xi</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span></span>
<span><span class="va">tau2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">d</span><span class="op">)</span></span>
<span><span class="va">nu</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">d</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">m</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">burnin</span><span class="op">+</span><span class="va">M</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co"># sample  beta from the full conditional</span></span>
<span>    <span class="va">B0.inv</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">B0inv.intcpt</span>, <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">lambda2</span><span class="op">*</span><span class="va">tau2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">Bn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">B0.inv</span><span class="op">+</span><span class="va">XX</span><span class="op">/</span><span class="va">sigma2</span><span class="op">)</span> </span>
<span>    <span class="va">bn</span> <span class="op">&lt;-</span> <span class="va">Bn</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="op">(</span><span class="va">B0.inv</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b0</span><span class="op">+</span><span class="va">Xy</span><span class="op">/</span><span class="va">sigma2</span><span class="op">)</span></span>
<span>    <span class="va">beta</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fl">1</span>,mean<span class="op">=</span><span class="va">bn</span>,sigma<span class="op">=</span><span class="va">Bn</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># sample lambda2 and nu</span></span>
<span>    <span class="va">lambda2</span><span class="op">=</span><span class="fu"><a href="../reference/InvGammaDist.html">rinvgamma</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">d</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>                      <span class="fl">1</span><span class="op">/</span><span class="va">xi</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">lambda2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">nu</span><span class="op">=</span><span class="fu"><a href="../reference/InvGammaDist.html">rinvgamma</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">lambda2</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co">#sample tau2 and xi</span></span>
<span>    <span class="va">tau2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InvGammaDist.html">rinvgamma</a></span><span class="op">(</span><span class="va">d</span>,<span class="fl">1</span>,</span>
<span>                   <span class="fl">1</span><span class="op">/</span><span class="va">nu</span><span class="op">+</span><span class="op">(</span><span class="va">beta</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">tau2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">xi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InvGammaDist.html">rinvgamma</a></span><span class="op">(</span><span class="va">d</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="va">tau2</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># sample sigma^2 from its full conditional</span></span>
<span>    <span class="va">eps</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">-</span><span class="va">X</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">beta</span></span>
<span>    <span class="va">CN</span> <span class="op">&lt;-</span> <span class="va">C0</span><span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/crossprod.html" class="external-link">crossprod</a></span><span class="op">(</span><span class="va">eps</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span></span>
<span>    <span class="va">sigma2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/InvGammaDist.html">rinvgamma</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">cN</span>,<span class="va">CN</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Save the draws</span></span>
<span>    <span class="va">betas</span><span class="op">[</span><span class="va">m</span>,<span class="op">]</span><span class="op">&lt;-</span><span class="va">beta</span></span>
<span>    <span class="va">lambda2s</span><span class="op">[</span><span class="va">m</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">lambda2</span></span>
<span>    <span class="va">nus</span><span class="op">[</span><span class="va">m</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">nu</span></span>
<span>    <span class="va">tau2s</span><span class="op">[</span><span class="va">m</span>,<span class="op">]</span><span class="op">&lt;-</span> <span class="va">tau2</span></span>
<span>    <span class="va">xis</span><span class="op">[</span><span class="va">m</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">xi</span></span>
<span>    <span class="va">sigma2s</span><span class="op">[</span><span class="va">m</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">sigma2</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Again we compose a table with posterior mean estimates and equal
tailed 95% credibility intervals</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">beta.res2</span><span class="op">&lt;-</span> <span class="va">betas</span><span class="op">[</span><span class="va">burnin</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">M</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="va">beta.eq2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">beta.res2</span>,<span class="fl">2</span>,<span class="va">eq.tails</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">beta.res2</span><span class="op">)</span>, <span class="va">beta.eq2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">res2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Intercept"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data.cen</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"post.mean"</span>, <span class="st">"2.5%"</span>, <span class="st">"97.5"</span> <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;           post.mean    2.5%   97.5</span></span>
<span><span class="co">#&gt; Intercept    19.118  17.566 20.682</span></span>
<span><span class="co">#&gt; Action       -0.608  -5.157  3.241</span></span>
<span><span class="co">#&gt; Adventure     1.988  -1.995  7.020</span></span>
<span><span class="co">#&gt; Animation    -6.541 -15.589  0.639</span></span>
<span><span class="co">#&gt; Comedy        0.967  -2.957  5.490</span></span>
<span><span class="co">#&gt; Crime         1.117  -2.320  5.183</span></span>
<span><span class="co">#&gt; Drama        -1.798  -6.344  1.819</span></span>
<span><span class="co">#&gt; Family        5.619  -1.184 14.902</span></span>
<span><span class="co">#&gt; Fantasy       2.735  -2.515  9.486</span></span>
<span><span class="co">#&gt; Mystery       1.246  -3.443  7.105</span></span>
<span><span class="co">#&gt; Romance      -0.340  -4.756  3.900</span></span>
<span><span class="co">#&gt; Sci-Fi        0.161  -4.891  5.384</span></span>
<span><span class="co">#&gt; Thriller      0.515  -3.366  4.752</span></span>
<span><span class="co">#&gt; PG13         -1.157  -5.906  3.652</span></span>
<span><span class="co">#&gt; R             2.244  -2.043  7.532</span></span>
<span><span class="co">#&gt; Budget        0.124   0.031  0.218</span></span>
<span><span class="co">#&gt; Weeks         0.498   0.098  0.898</span></span>
<span><span class="co">#&gt; Screens       0.950   0.551  1.381</span></span>
<span><span class="co">#&gt; S-21-27      -0.336  -1.425  0.734</span></span>
<span><span class="co">#&gt; S-14-20       0.003  -1.659  1.652</span></span>
<span><span class="co">#&gt; S-7-13        0.441  -2.091  2.993</span></span>
<span><span class="co">#&gt; S-4-6        -0.590  -4.034  2.273</span></span>
<span><span class="co">#&gt; S-1-3         1.729  -1.209  5.300</span></span>
<span><span class="co">#&gt; Vol-21-27    -7.355 -29.362  4.704</span></span>
<span><span class="co">#&gt; Vol-14-20    -2.714 -19.453 11.672</span></span>
<span><span class="co">#&gt; Vol-7-13     -2.527 -23.094 14.962</span></span>
<span><span class="co">#&gt; Vol-4-6      -4.778 -21.352  7.586</span></span>
<span><span class="co">#&gt; Vol-1-3      20.087  11.323 25.089</span></span>
<span></span>
<span><span class="va">sigma2.res2</span><span class="op">&lt;-</span> <span class="va">sigma2s</span><span class="op">[</span><span class="va">burnin</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">M</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sigma2.res2</span><span class="op">)</span>, <span class="fu">eq.tails</span><span class="op">(</span><span class="va">sigma2.res2</span><span class="op">)</span><span class="op">)</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          2.5%  97.5% </span></span>
<span><span class="co">#&gt; 62.952 44.696 92.083</span></span></code></pre></div>
<p>We next have a look at the posterior distributions: first under the
semi-conjugate priors and then under the Horseshoe prior</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">d</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">beta.res1</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="Chapter06_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">d</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">beta.res2</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span> </span></code></pre></div>
<p><img src="Chapter06_files/figure-html/unnamed-chunk-9-2.png" width="768">
Whereas the posterior distributions are symmetric under the
semi-conjugate prior this is not the case under the Horseshoe prior.</p>
<p>We next investigate now the MCMC plots.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">d</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">beta.res1</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="Chapter06_files/figure-html/unnamed-chunk-10-1.png" width="768"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">d</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">beta.res2</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span><span class="op">}</span> </span></code></pre></div>
<p><img src="Chapter06_files/figure-html/unnamed-chunk-10-2.png" width="768">
Finally have a look at boxplots of the posterior distributions of the
local shrinkage parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\tau_j</annotation></semantics></math>under
the horseshoe prior</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">graphics</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">tau2.res</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chapter06_files/figure-html/unnamed-chunk-11-1.png" width="768"></p>
<p>The residuals of the model are however not normally distributed.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res2</span><span class="op">=</span><span class="va">y</span><span class="op">-</span><span class="va">X</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">beta.res2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqnorm</a></span><span class="op">(</span><span class="va">res1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqnorm</a></span><span class="op">(</span><span class="va">res2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chapter06_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregor Kastner, Sylvia Frühwirth-Schnatter, Bettina Grün, Helga Wagner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
