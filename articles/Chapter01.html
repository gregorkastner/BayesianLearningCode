<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 1: From Bayes’ Rule to Bayes’ Theorem • BayesianLearningCode</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chapter 1: From Bayes’ Rule to Bayes’ Theorem">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BayesianLearningCode</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Chapter01.html">Chapter 1: From Bayes’ Rule to Bayes’ Theorem</a></li>
    <li><a class="dropdown-item" href="../articles/Chapter02.html">Chapter 2: A First Bayesian Analysis of Count Data</a></li>
    <li><a class="dropdown-item" href="../articles/Chapter03.html">Chapter 3: A First Bayesian Analysis of Unknown Probabilities</a></li>
    <li><a class="dropdown-item" href="../articles/Chapter04.html">Chapter 4: A First Bayesian Analysis of Continuous Data</a></li>
    <li><a class="dropdown-item" href="../articles/Chapter05.html">Chapter 5: Learning More About Bayesian Learning</a></li>
    <li><a class="dropdown-item" href="../articles/Chapter06.html">Chapter 6: The Bayesian Approach to Standard Regression Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Chapter07.html">Chapter 7: Introduction to Bayesian Time Series Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Chapter08.html">Chapter 8: Bayesian Learning Beyond Standard Regression Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/Chapter09.html">Chapter 9: Bayesian Predictive Analysis</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Chapter 1: From Bayes’ Rule to Bayes’ Theorem</h1>
            
      

      <div class="d-none name"><code>Chapter01.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="section-1-3-naive-bayes-classifiers">Section 1.3: Naive Bayes classifiers<a class="anchor" aria-label="anchor" href="#section-1-3-naive-bayes-classifiers"></a>
</h2>
<div class="section level3">
<h3 id="example-1-3-and-1-4-classifying-categorical-observations-into-two-states">Example 1.3 and 1.4: Classifying categorical observations into two
states<a class="anchor" aria-label="anchor" href="#example-1-3-and-1-4-classifying-categorical-observations-into-two-states"></a>
</h3>
<p>We have two firms, a reliable firm
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.7</mn></mrow><annotation encoding="application/x-tex">Pr(A) = 0.7</annotation></semantics></math>
and a less reliable firm
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>A</mi><mi>C</mi></msup><annotation encoding="application/x-tex">A^C</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>A</mi><mi>C</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mn>0.7</mn><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">Pr(A^C) = 1 - 0.7 = 0.3</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PrA</span> <span class="op">&lt;-</span> <span class="fl">0.7</span></span>
<span><span class="va">PrAC</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">PrA</span></span></code></pre></div>
<p>The failure rate, i.e., the probability of a faulty item, is 0.01 for
the reliable firm
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and 0.05 for the less reliable firm
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>A</mi><mi>C</mi></msup><annotation encoding="application/x-tex">A^C</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PrFA</span> <span class="op">&lt;-</span> <span class="fl">0.01</span></span>
<span><span class="va">PrFAC</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></code></pre></div>
<p>Assume that we observe any number of failures
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
between 0 and 6 (from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">N = 100</annotation></semantics></math>
observations in total), but we don’t know whether the items are from
company
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>A</mi><mi>C</mi></msup><annotation encoding="application/x-tex">A^C</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">6</span></span></code></pre></div>
<p>We can now compute the probability of dealing with items from company
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
by using Bayes’ theorem.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta1_y_unnormalized</span> <span class="op">&lt;-</span> <span class="va">PrFA</span> <span class="op">^</span> <span class="va">y</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">PrFA</span><span class="op">)</span> <span class="op">^</span> <span class="op">(</span><span class="va">N</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="va">PrA</span></span>
<span><span class="va">theta0_y_unnormalized</span> <span class="op">&lt;-</span> <span class="va">PrFAC</span> <span class="op">^</span> <span class="va">y</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">PrFAC</span><span class="op">)</span> <span class="op">^</span> <span class="op">(</span><span class="va">N</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="va">PrAC</span></span>
<span><span class="va">normalizer</span> <span class="op">&lt;-</span> <span class="va">theta1_y_unnormalized</span> <span class="op">+</span> <span class="va">theta0_y_unnormalized</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="st">"reliable company"</span> <span class="op">=</span> <span class="va">theta1_y_unnormalized</span> <span class="op">/</span> <span class="va">normalizer</span>,</span>
<span>             <span class="st">"less reliable company"</span> <span class="op">=</span> <span class="va">theta0_y_unnormalized</span> <span class="op">/</span> <span class="va">normalizer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">y</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="34%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">reliable company</td>
<td align="right">0.993</td>
<td align="right">0.965</td>
<td align="right">0.842</td>
<td align="right">0.505</td>
<td align="right">0.164</td>
<td align="right">0.036</td>
<td align="right">0.007</td>
</tr>
<tr class="even">
<td align="left">less reliable company</td>
<td align="right">0.007</td>
<td align="right">0.035</td>
<td align="right">0.158</td>
<td align="right">0.495</td>
<td align="right">0.836</td>
<td align="right">0.964</td>
<td align="right">0.993</td>
</tr>
</tbody>
</table>
<p>Note that, of course, the probabilities of dealing with items from
company
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>A</mi><mi>C</mi></msup><annotation encoding="application/x-tex">A^C</annotation></semantics></math>
are complementary (i.e., sum to one).</p>
<p>Assuming we do not have any prior information about the probability
of occurrence of company
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>,
we could simply set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>A</mi><mi>C</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">Pr(A) = Pr(A^C) = 0.5</annotation></semantics></math>
and recompute the posterior probabilities.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PrA</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">PrAC</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">PrA</span></span>
<span></span>
<span><span class="va">theta1_y_unnormalized</span> <span class="op">&lt;-</span> <span class="va">PrFA</span> <span class="op">^</span> <span class="va">y</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">PrFA</span><span class="op">)</span> <span class="op">^</span> <span class="op">(</span><span class="va">N</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="va">PrA</span></span>
<span><span class="va">theta0_y_unnormalized</span> <span class="op">&lt;-</span> <span class="va">PrFAC</span> <span class="op">^</span> <span class="va">y</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">PrFAC</span><span class="op">)</span> <span class="op">^</span> <span class="op">(</span><span class="va">N</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span> <span class="op">*</span> <span class="va">PrAC</span></span>
<span><span class="va">normalizer</span> <span class="op">&lt;-</span> <span class="va">theta1_y_unnormalized</span> <span class="op">+</span> <span class="va">theta0_y_unnormalized</span></span>
<span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">theta1_y_unnormalized</span><span class="op">/</span> <span class="va">normalizer</span>,</span>
<span>             <span class="va">theta0_y_unnormalized</span><span class="op">/</span> <span class="va">normalizer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">y</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"reliable company"</span>, <span class="st">"less reliable company"</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="34%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">0</th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
<th align="right">5</th>
<th align="right">6</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">reliable company</td>
<td align="right">0.984</td>
<td align="right">0.922</td>
<td align="right">0.695</td>
<td align="right">0.304</td>
<td align="right">0.077</td>
<td align="right">0.016</td>
<td align="right">0.003</td>
</tr>
<tr class="even">
<td align="left">less reliable company</td>
<td align="right">0.016</td>
<td align="right">0.078</td>
<td align="right">0.305</td>
<td align="right">0.696</td>
<td align="right">0.923</td>
<td align="right">0.984</td>
<td align="right">0.997</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="example-1-5-classifying-continuous-observations-into-two-states">Example 1.5: Classifying continuous observations into two
states<a class="anchor" aria-label="anchor" href="#example-1-5-classifying-continuous-observations-into-two-states"></a>
</h3>
<p>We have a Bernoulli random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ϑ</mi><annotation encoding="application/x-tex">\vartheta</annotation></semantics></math>
with prior probability
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ϑ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.55</mn><mo>,</mo></mrow><annotation encoding="application/x-tex">Pr(\vartheta) = 0.55,</annotation></semantics></math>
and we know for the females that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>ϑ</mi><mn>1</mn></msub><mo>∼</mo><mi>E</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">y|\vartheta_1 \sim Exp(\lambda),</annotation></semantics></math>
and for the males that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo stretchy="false" form="prefix">|</mo><msub><mi>ϑ</mi><mn>0</mn></msub><mo>∼</mo><mi>G</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">y|\vartheta_0 \sim G(\alpha, \beta),</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>1</mn><mi>/</mi><mn>2.2</mn></mrow><annotation encoding="application/x-tex">\lambda = 1/2.2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">\alpha = 5</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>5</mn><mi>/</mi><mn>5.5</mn></mrow><annotation encoding="application/x-tex">\beta = 5/5.5</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Prtheta</span> <span class="op">=</span> <span class="fl">0.55</span></span>
<span><span class="va">lambda</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2.2</span></span>
<span><span class="va">alpha</span> <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="va">beta</span> <span class="op">=</span> <span class="fl">5</span><span class="op">/</span><span class="fl">5.5</span></span></code></pre></div>
<p>We now plot the conditional densities for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>10</mn><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">y \in [0,10]</annotation></semantics></math>.
Then, we compute the non-normalized posteriors for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo>,</mo><mn>6</mn><mo>,</mo><mn>8</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">y \in \{1, 2, 3, 6, 8\}</annotation></semantics></math>,
mark those in the plot, and add lines to visualize the non-normalized
posteriors.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y_all</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">y_all</span>, <span class="va">lambda</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">"Distance"</span>, ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>      main <span class="op">=</span> <span class="st">"Conditional densities and non-normalized posteriors"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">y_all</span>, <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">y_all</span>, <span class="va">alpha</span>, <span class="va">beta</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">theta1_y_unnormalized</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">lambda</span><span class="op">)</span> <span class="op">*</span> <span class="va">Prtheta</span></span>
<span><span class="va">theta0_y_unnormalized</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">alpha</span>, <span class="va">beta</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">Prtheta</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">theta1_y_unnormalized</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">theta0_y_unnormalized</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">theta1_y_all_unnormalized</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">y_all</span>, <span class="va">lambda</span><span class="op">)</span> <span class="op">*</span> <span class="va">Prtheta</span></span>
<span><span class="va">theta0_y_all_unnormalized</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">y_all</span>, <span class="va">alpha</span>, <span class="va">beta</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">Prtheta</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">y_all</span>, <span class="va">theta1_y_all_unnormalized</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">y_all</span>, <span class="va">theta0_y_all_unnormalized</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Conditional density (female)"</span>,</span>
<span>                     <span class="st">"Conditional density (male)"</span>,</span>
<span>                     <span class="st">"Non-normalized posterior (female)"</span>,</span>
<span>                     <span class="st">"Non-normalized posterior (male)"</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chapter01_files/figure-html/unnamed-chunk-9-1.png" width="768"></p>
<p>Finally, here are the posterior probabilities. Note that each ratio
of the pairs of corresponding posterior probabilities is the same as
each ratio of the heights of the vertically corresponding points in the
graph.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normalizer</span> <span class="op">&lt;-</span> <span class="va">theta1_y_unnormalized</span> <span class="op">+</span> <span class="va">theta0_y_unnormalized</span></span>
<span><span class="va">theta1_y</span> <span class="op">&lt;-</span> <span class="va">theta1_y_unnormalized</span> <span class="op">/</span> <span class="va">normalizer</span></span>
<span><span class="va">theta0_y</span> <span class="op">&lt;-</span> <span class="va">theta0_y_unnormalized</span> <span class="op">/</span> <span class="va">normalizer</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span>female <span class="op">=</span> <span class="va">theta1_y</span>, male <span class="op">=</span> <span class="va">theta0_y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">y</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">res</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">6</th>
<th align="right">8</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">female</td>
<td align="right">0.971</td>
<td align="right">0.769</td>
<td align="right">0.509</td>
<td align="right">0.202</td>
<td align="right">0.166</td>
</tr>
<tr class="even">
<td align="left">male</td>
<td align="right">0.029</td>
<td align="right">0.231</td>
<td align="right">0.491</td>
<td align="right">0.798</td>
<td align="right">0.834</td>
</tr>
</tbody>
</table>
<p>We also plot the posterior probabilities for distance values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
ranging from 0 to 10 in steps of 0.2 in a stacked barplot.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">normalizer</span> <span class="op">&lt;-</span> <span class="va">theta1_y_all_unnormalized</span> <span class="op">+</span> <span class="va">theta0_y_all_unnormalized</span></span>
<span><span class="va">theta1_y_all</span> <span class="op">&lt;-</span> <span class="va">theta1_y_all_unnormalized</span> <span class="op">/</span> <span class="va">normalizer</span></span>
<span><span class="va">theta0_y_all</span> <span class="op">&lt;-</span> <span class="va">theta0_y_all_unnormalized</span> <span class="op">/</span> <span class="va">normalizer</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span>female <span class="op">=</span> <span class="va">theta1_y_all</span>, male <span class="op">=</span> <span class="va">theta0_y_all</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">y_all</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="va">res</span>, main <span class="op">=</span> <span class="st">"Posterior probabilities"</span>, xlab <span class="op">=</span> <span class="st">"Distance"</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"Probabilities"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Chapter01_files/figure-html/unnamed-chunk-11-1.png" width="768"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Gregor Kastner, Sylvia Frühwirth-Schnatter, Bettina Grün, Helga Wagner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
